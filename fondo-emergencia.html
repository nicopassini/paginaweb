<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="¬øCu√°nto necesit√°s ahorrar para estar protegido? Calcul√° tu fondo ideal y arm√° un plan mensual. Gratis.">
<meta name="author" content="Nico Passini">
<meta name="robots" content="index, follow">
<link rel="canonical" href="https://nicopassini.com/fondo-emergencia.html">
<!-- Open Graph -->
<meta property="og:type" content="website">
<meta property="og:title" content="Calculadora Fondo de Emergencia | Nico Passini">
<meta property="og:description" content="¬øCu√°nto necesit√°s ahorrar para estar protegido? Calcul√° tu fondo ideal y arm√° un plan mensual. Gratis.">
<meta property="og:url" content="https://nicopassini.com/fondo-emergencia.html">
<meta property="og:site_name" content="Nico Passini">
<meta property="og:locale" content="es_AR">
<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Calculadora Fondo de Emergencia | Nico Passini">
<meta name="twitter:description" content="¬øCu√°nto necesit√°s ahorrar para estar protegido? Calcul√° tu fondo ideal y arm√° un plan mensual. Gratis.">
<meta name="twitter:creator" content="@nicopassini_">
<!-- Favicon -->
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üí∞</text></svg>">
<title>Fondo de Emergencia | M√©todo FBC</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;500;600;700&family=Questrial&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<style>
@font-face{font-family:'Century Gothic Fallback';src:local('Century Gothic'),local('CenturyGothic');}
:root{--navy:#1a3753;--blue:#0b80e1;--white:#fff;--teal:#11b3b7;--bg:#0d1b2e;--surface:#132640;--surface-2:#17304d;--surface-3:#1c3a5a;--border:#1f4672;--text:#e4eaf2;--text-muted:#8da4bf;--accent:var(--teal);--accent-glow:rgba(17,179,183,.15);--green:#11b3b7;--green-bg:rgba(17,179,183,.12);--orange:#f0a030;--orange-bg:rgba(240,160,48,.12);--red:#e85454;--red-bg:rgba(232,84,84,.12);--radius:16px;--radius-sm:10px;--font-main:'Century Gothic Fallback','Questrial','Futura','Trebuchet MS',Arial,sans-serif;}
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:var(--font-main);background:var(--bg);color:var(--text);min-height:100vh;overflow-x:hidden;}
.noise-overlay{position:fixed;top:0;left:0;width:100%;height:100%;opacity:.025;pointer-events:none;z-index:0;background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");}
.glow-orb{position:fixed;width:600px;height:600px;border-radius:50%;filter:blur(130px);opacity:.06;pointer-events:none;z-index:0;}
.glow-orb-1{top:-200px;right:-100px;background:var(--blue);}.glow-orb-2{bottom:-200px;left:-100px;background:var(--teal);}
.container{position:relative;z-index:1;max-width:800px;margin:0 auto;padding:40px 20px 60px;}
.back-link{display:inline-flex;align-items:center;gap:6px;color:var(--text-muted);text-decoration:none;font-size:16px;margin-bottom:24px;transition:color .2s;animation:fadeInUp .5s ease;}.back-link:hover{color:var(--teal);}
.header{text-align:center;margin-bottom:40px;animation:fadeInUp .7s ease;}
.brand-logo{text-align:center;margin-bottom:28px;}
.brand-wordmark{font-family:'Cormorant Garamond',Georgia,serif;font-size:32px;font-weight:300;letter-spacing:6px;text-transform:uppercase;color:var(--white);display:inline-block;}
.brand-wordmark-line{display:block;width:100%;height:1px;background:linear-gradient(90deg,transparent,var(--blue),var(--teal),transparent);margin-top:6px;}
.header h1{font-size:clamp(28px,5vw,42px);font-weight:700;line-height:1.15;margin-bottom:14px;background:linear-gradient(135deg,var(--white),var(--teal));-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
.header .subtitle{color:var(--text-muted);font-size:16px;line-height:1.6;max-width:560px;margin:0 auto;}
.card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:28px;margin-bottom:24px;animation:fadeInUp .7s ease .15s both;position:relative;overflow:hidden;}
.card::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;background:linear-gradient(90deg,transparent,var(--blue),var(--teal),transparent);opacity:.6;}
.card-title{font-size:15px;font-weight:700;letter-spacing:2.5px;text-transform:uppercase;color:var(--blue);margin-bottom:24px;display:flex;align-items:center;gap:10px;}
.card-title .icon{width:32px;height:32px;background:rgba(11,128,225,.12);border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:16px;}
.field{margin-bottom:20px;}
.field label{display:block;font-size:15px;font-weight:600;color:var(--text-muted);margin-bottom:8px;}
.input-wrap{position:relative;}
.input-wrap .prefix,.input-wrap .suffix{position:absolute;top:50%;transform:translateY(-50%);font-size:16px;color:var(--text-muted);font-weight:500;pointer-events:none;}
.input-wrap .prefix{left:16px;}.input-wrap .suffix{right:16px;}
input[type="number"]{width:100%;background:var(--surface-2);border:1.5px solid var(--border);border-radius:var(--radius-sm);padding:14px 16px;font-family:var(--font-main);font-size:16px;font-weight:600;color:var(--text);transition:all .25s;-moz-appearance:textfield;}
input::-webkit-outer-spin-button,input::-webkit-inner-spin-button{-webkit-appearance:none;}
input:focus{outline:none;border-color:var(--blue);box-shadow:0 0 0 3px rgba(11,128,225,.2);}
.input-with-prefix{padding-left:36px!important;}.input-with-suffix{padding-right:60px!important;}
.ars-equiv{font-size:15px;color:var(--text-muted);margin-top:5px;opacity:.7;}
.ars-config{display:flex;align-items:center;gap:10px;padding:12px 16px;background:var(--surface-2);border-radius:var(--radius-sm);border:1px solid var(--border);margin-bottom:20px;}
.ars-config label{font-size:15px;color:var(--text-muted);font-weight:600;white-space:nowrap;}
.fields-row{display:grid;grid-template-columns:1fr 1fr;gap:14px;}
@media(max-width:500px){.fields-row{grid-template-columns:1fr;}}

/* MONTHS TOGGLE */
.months-toggle{display:flex;gap:8px;margin-bottom:20px;}
.month-btn{flex:1;padding:16px;border:1.5px solid var(--border);border-radius:var(--radius-sm);background:var(--surface-2);color:var(--text-muted);font-family:var(--font-main);font-size:15px;font-weight:600;cursor:pointer;transition:all .25s;text-align:center;}
.month-btn:hover{border-color:var(--text-muted);}
.month-btn.active{border-color:var(--teal);background:var(--accent-glow);color:var(--teal);}
.month-btn .num{display:block;font-size:28px;font-weight:700;margin-bottom:2px;}

/* EXPENSE ITEMS */
.expense-list{margin-bottom:16px;}
.expense-item{display:grid;grid-template-columns:1fr 120px 36px;gap:12px;align-items:end;background:var(--surface-2);border:1px solid var(--border);border-radius:var(--radius-sm);padding:14px;margin-bottom:8px;animation:fadeInUp .3s ease;}
@media(max-width:500px){.expense-item{grid-template-columns:1fr 100px 36px;}}
.btn-remove{width:36px;height:38px;border:1px solid var(--border);border-radius:8px;background:transparent;color:var(--red);font-size:18px;cursor:pointer;transition:all .2s;display:flex;align-items:center;justify-content:center;align-self:end;}
.btn-remove:hover{background:var(--red-bg);border-color:var(--red);}
.btn-add{width:100%;padding:12px;border:2px dashed var(--border);border-radius:var(--radius-sm);background:transparent;color:var(--text-muted);font-family:var(--font-main);font-size:16px;cursor:pointer;transition:all .2s;}
.btn-add:hover{border-color:var(--teal);color:var(--teal);}

.calc-btn{width:100%;padding:18px;background:linear-gradient(135deg,var(--blue),var(--teal));border:none;border-radius:var(--radius-sm);font-family:var(--font-main);font-size:17px;font-weight:700;color:var(--white);cursor:pointer;transition:all .3s;margin-top:8px;}
.calc-btn:hover{transform:translateY(-2px);box-shadow:0 8px 30px rgba(11,128,225,.3);}

/* RESULTS */
.results{display:none;}.results.show{display:block;animation:fadeInUp .6s ease;}

/* PROGRESS RING */
.ring-hero{text-align:center;padding:36px 28px;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);margin-bottom:24px;position:relative;overflow:hidden;}
.ring-hero::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;}
.ring-hero.status-red::before{background:var(--red);}
.ring-hero.status-orange::before{background:var(--orange);}
.ring-hero.status-green::before{background:var(--teal);}
.ring-wrap{width:200px;height:200px;margin:0 auto 20px;position:relative;}
.ring-wrap svg{width:200px;height:200px;position:absolute;top:0;left:0;}
.ring-wrap svg circle{fill:none;stroke-width:10;cx:100;cy:100;r:85;}
.ring-bg circle{stroke:var(--surface-3);}
.ring-fill circle{stroke-dasharray:534.07;stroke-dashoffset:534.07;stroke-linecap:round;transform:rotate(-90deg);transform-origin:center;transition:stroke-dashoffset 1.5s ease;}
.ring-inner{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);text-align:center;}
.ring-pct{font-size:48px;font-weight:700;line-height:1;}
.ring-label{font-size:15px;color:var(--text-muted);}
.hero-status{display:inline-flex;align-items:center;gap:6px;padding:8px 20px;border-radius:100px;font-size:15px;font-weight:700;letter-spacing:1px;text-transform:uppercase;margin-bottom:12px;}
.hero-title{font-size:18px;color:var(--text-muted);line-height:1.5;}
.hero-amounts{margin-top:16px;display:flex;justify-content:center;gap:24px;flex-wrap:wrap;}
.ha-item{text-align:center;}
.ha-label{font-size:13px;color:var(--text-muted);text-transform:uppercase;letter-spacing:1px;}
.ha-value{font-size:24px;font-weight:700;margin-top:2px;}
.ha-ars{font-size:15px;color:var(--text-muted);opacity:.7;}

/* PLAN */
.plan-section{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:28px;margin-bottom:24px;}
.plan-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:16px;}
@media(max-width:500px){.plan-grid{grid-template-columns:1fr;}}
.plan-card{background:var(--surface-2);border:1px solid var(--border);border-radius:var(--radius-sm);padding:20px 16px;text-align:center;}
.plan-card .pc-months{font-size:15px;color:var(--text-muted);text-transform:uppercase;letter-spacing:1px;}
.plan-card .pc-amount{font-size:24px;font-weight:700;color:var(--teal);margin:6px 0 2px;}
.plan-card .pc-sub{font-size:15px;color:var(--text-muted);}

/* CHART */
.chart-container{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:24px;margin-bottom:24px;}
.chart-container canvas{max-height:300px;}

/* WHERE TO KEEP */
.where-section{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:28px;margin-bottom:24px;}
.where-grid{display:flex;flex-direction:column;gap:10px;margin-top:16px;}
.where-card{display:flex;align-items:center;gap:14px;background:var(--surface-2);border:1px solid var(--border);border-radius:var(--radius-sm);padding:16px;transition:all .25s;}
.where-card:hover{border-color:var(--teal);}
.where-icon{font-size:24px;flex-shrink:0;}
.where-info{flex:1;}
.where-name{font-size:16px;font-weight:700;color:var(--white);}
.where-desc{font-size:15px;color:var(--text-muted);margin-top:2px;line-height:1.4;}
.where-badge{padding:4px 10px;border-radius:100px;font-size:12px;font-weight:700;letter-spacing:1px;text-transform:uppercase;flex-shrink:0;}

/* RECO */
.reco-box{background:var(--surface-2);border-radius:var(--radius-sm);padding:24px;border-left:3px solid;margin-bottom:16px;}
.reco-box.reco-green{border-color:var(--green);}.reco-box.reco-orange{border-color:var(--orange);}.reco-box.reco-red{border-color:var(--red);}
.reco-box h4{font-size:15px;font-weight:700;margin-bottom:10px;display:flex;align-items:center;gap:8px;}
.reco-green h4{color:var(--green);}.reco-orange h4{color:var(--orange);}.reco-red h4{color:var(--red);}
.reco-box p{font-size:16px;color:var(--text-muted);line-height:1.65;}
.reco-box ul{margin-top:10px;padding-left:0;list-style:none;}
.reco-box li{font-size:15px;color:var(--text-muted);line-height:1.6;padding:4px 0 4px 20px;position:relative;}
.reco-box li::before{content:'‚Üí';position:absolute;left:0;color:var(--teal);font-weight:700;}

/* CURRENCY BUTTONS */
.cur-grid{display:flex;gap:8px;margin-bottom:16px;}
.cur-btn{flex:1;padding:16px 12px;border:1.5px solid var(--border);border-radius:var(--radius-sm);background:var(--surface-2);color:var(--text-muted);font-family:var(--font-main);font-size:15px;font-weight:600;cursor:pointer;transition:all .25s;text-align:center;}
.cur-btn:hover{border-color:var(--text-muted);}
.cur-btn.active{border-color:var(--teal);background:var(--accent-glow);color:var(--teal);}
.cur-btn .c-icon{font-size:22px;display:block;margin-bottom:4px;}
.cur-btn .c-name{display:block;font-size:15px;}

.cta-card{background:linear-gradient(135deg,var(--surface-2),var(--surface-3));border:1px solid var(--teal);border-radius:var(--radius);padding:32px 28px;text-align:center;margin-bottom:24px;}
.cta-card h3{font-size:20px;color:var(--white);margin-bottom:10px;}
.cta-card p{color:var(--text-muted);font-size:15px;margin-bottom:18px;line-height:1.6;}
.btn-cta{display:inline-block;padding:14px 36px;border-radius:var(--radius-sm);background:linear-gradient(135deg,var(--blue),var(--teal));color:white;text-decoration:none;font-weight:600;font-size:15px;transition:all .3s;}
.btn-cta:hover{transform:translateY(-2px);box-shadow:0 8px 25px rgba(11,128,225,.3);}
.footer{text-align:center;padding-top:20px;border-top:1px solid var(--border);color:var(--text-muted);font-size:15px;line-height:1.6;}
.footer a{color:var(--teal);text-decoration:none;}

/* SHARE CARD */
.share-card{position:absolute;left:-9999px;top:0;width:1080px;background:linear-gradient(160deg,#0d1b2e 0%,#132640 50%,#0d1b2e 100%);padding:60px;font-family:var(--font-main);color:var(--text);}
.sc-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:50px;}
.sc-brand{font-family:'Cormorant Garamond',Georgia,serif;font-size:24px;letter-spacing:4px;text-transform:uppercase;color:var(--white);}
.sc-tool{font-size:16px;color:var(--teal);letter-spacing:2px;text-transform:uppercase;}
.sc-main{text-align:center;margin-bottom:40px;}
.sc-main-label{font-size:20px;color:var(--text-muted);text-transform:uppercase;letter-spacing:3px;margin-bottom:10px;}
.sc-main-amount{font-size:72px;font-weight:700;line-height:1;}
.sc-main-sub{font-size:22px;color:var(--text-muted);margin-top:8px;}
.sc-stats{display:flex;gap:16px;margin-bottom:40px;}
.sc-stat{background:rgba(23,48,77,.8);border:1px solid var(--border);border-radius:12px;padding:24px;flex:1;text-align:center;}
.sc-stat-label{font-size:16px;color:var(--text-muted);margin-bottom:6px;}
.sc-stat-val{font-size:28px;font-weight:700;}
.sc-footer{display:flex;align-items:center;justify-content:space-between;border-top:1px solid var(--border);padding-top:24px;}
.sc-footer-text{font-size:16px;color:var(--text-muted);}
.sc-footer-ig{font-size:20px;font-weight:600;color:var(--teal);}

.toast{position:fixed;bottom:30px;left:50%;transform:translateX(-50%) translateY(100px);background:var(--teal);color:var(--bg);padding:14px 28px;border-radius:var(--radius-sm);font-weight:600;font-size:16px;z-index:100;transition:transform .4s ease;pointer-events:none;}
.toast.show{transform:translateX(-50%) translateY(0);}
@keyframes fadeInUp{from{opacity:0;transform:translateY(18px);}to{opacity:1;transform:translateY(0);}}
::-webkit-scrollbar{width:8px;}::-webkit-scrollbar-track{background:var(--bg);}::-webkit-scrollbar-thumb{background:var(--surface-3);border-radius:4px;}
</style>
</head>
<body>
<div class="noise-overlay"></div>
<div class="glow-orb glow-orb-1"></div>
<div class="glow-orb glow-orb-2"></div>
<div class="container">
<a href="index.html" class="back-link">‚Üê Volver a herramientas</a>
<div class="header">
  <div class="brand-logo"><span class="brand-wordmark">NICO PASSINI<span class="brand-wordmark-line"></span></span></div>
  <h1>Fondo de Emergencia üõ°Ô∏è</h1>
  <p class="subtitle">Tu colch√≥n financiero ante imprevistos. Calcul√° cu√°nto necesit√°s, cu√°nto te falta y arm√° un plan para completarlo.</p>
</div>

<!-- MONEDA -->
<div class="card">
  <div class="card-title"><div class="icon">üí±</div> Moneda</div>
  <div class="cur-grid">
    <button class="cur-btn active" id="btnARS" onclick="setCurrency('ARS')"><span class="c-icon">üá¶üá∑</span><span class="c-name">Pesos (ARS)</span></button>
    <button class="cur-btn" id="btnUSD" onclick="setCurrency('USD')"><span class="c-icon">üá∫üá∏</span><span class="c-name">D√≥lares (USD)</span></button>
  </div>
  <div class="ars-config" id="arsConfigWrap">
    <label>USD/ARS:</label>
    <div class="input-wrap"><span class="prefix">$</span><input type="number" id="arsRate" value="1200" min="1" style="width:120px;padding-left:28px;" oninput="updateAllEquiv()"></div>
    <span id="arsSource" style="font-size:13px;color:var(--text-muted);opacity:.6;"></span>
  </div>
</div>

<div class="card">
  <div class="card-title"><div class="icon">üõ°Ô∏è</div> ¬øCu√°ntos meses de cobertura?</div>
  <div class="months-toggle">
    <button class="month-btn" onclick="setMonths(3, this)"><span class="num">3</span>meses</button>
    <button class="month-btn active" onclick="setMonths(6, this)"><span class="num">6</span>meses</button>
  </div>
  <p style="font-size:15px;color:var(--text-muted);line-height:1.5;">3 meses es el m√≠nimo recomendado. 6 meses te da mucha m√°s tranquilidad ante p√©rdida de empleo o emergencias m√©dicas.</p>
</div>

<div class="card">
  <div class="card-title"><div class="icon">üí∏</div> Tus gastos mensuales esenciales</div>
  <p style="font-size:15px;color:var(--text-muted);margin-bottom:16px;">Solo gastos que NO pod√©s dejar de pagar: alquiler, servicios, comida, transporte, salud, deudas m√≠nimas.</p>
  <div class="expense-list" id="expenseList"></div>
  <button class="btn-add" onclick="addExpense()">+ Agregar gasto</button>
</div>

<div class="card">
  <div class="card-title"><div class="icon">üí∞</div> Tu situaci√≥n actual</div>
  <div class="field">
    <label>¬øCu√°nto ten√©s ahorrado actualmente para emergencias?</label>
    <div class="input-wrap"><span class="prefix">$</span><input type="number" id="currentSaved" value="0" min="0" class="input-with-prefix input-with-suffix" oninput="showEquiv(this,'savedEquiv')"><span class="suffix" id="savedSuffix">ARS</span></div>
    <div class="ars-equiv" id="savedEquiv"></div>
  </div>
  <button class="calc-btn" onclick="calculate()">Calcular mi fondo de emergencia ‚Üí</button>
</div>

<!-- RESULTS -->
<div class="results" id="results">
  <!-- RING -->
  <div class="ring-hero" id="ringHero">
    <div class="ring-wrap">
      <svg class="ring-bg" viewBox="0 0 200 200"><circle/></svg>
      <svg class="ring-fill" viewBox="0 0 200 200"><circle id="ringCircle"/></svg>
      <div class="ring-inner"><div class="ring-pct" id="ringPct">0%</div><div class="ring-label">completado</div></div>
    </div>
    <div class="hero-status" id="heroStatus"></div>
    <div class="hero-title" id="heroTitle"></div>
    <div class="hero-amounts">
      <div class="ha-item"><div class="ha-label">Objetivo</div><div class="ha-value" id="haGoal" style="color:var(--teal);"></div><div class="ha-ars" id="haGoalARS"></div></div>
      <div class="ha-item"><div class="ha-label">Ten√©s</div><div class="ha-value" id="haHave"></div><div class="ha-ars" id="haHaveARS"></div></div>
      <div class="ha-item"><div class="ha-label">Te falta</div><div class="ha-value" id="haNeed" style="color:var(--orange);"></div><div class="ha-ars" id="haNeedARS"></div></div>
    </div>
  </div>

  <!-- PLAN -->
  <div class="plan-section">
    <div class="card-title"><div class="icon">üìÖ</div> Plan de ahorro para completarlo</div>
    <p style="font-size:16px;color:var(--text-muted);margin-bottom:4px;" id="planDesc"></p>
    <div class="plan-grid" id="planGrid"></div>
  </div>

  <!-- CHART -->
  <div class="chart-container">
    <div class="card-title"><div class="icon">üìä</div> Progreso mes a mes</div>
    <canvas id="fundChart"></canvas>
  </div>

  <!-- WHERE TO KEEP -->
  <div class="where-section">
    <div class="card-title"><div class="icon">üè¶</div> ¬øD√≥nde guardar tu fondo?</div>
    <p style="font-size:16px;color:var(--text-muted);margin-bottom:4px;">Tu fondo de emergencia debe ser l√≠quido (que puedas sacarlo r√°pido) y seguro. No es para invertir.</p>
    <div class="where-grid" id="whereGrid"></div>
  </div>

  <!-- RECO -->
  <div id="recoContainer"></div>

  <!-- SHARE -->
  <div style="text-align:center;margin-bottom:24px;">
    <h3 style="font-size:18px;font-weight:700;color:var(--white);margin-bottom:8px;">üì≤ Compart√≠ tu resultado</h3>
    <p style="font-size:16px;color:var(--text-muted);margin-bottom:20px;">Descarg√° tu imagen o compartila directo en redes</p>
    <div style="display:flex;gap:10px;justify-content:center;flex-wrap:wrap;">
      <button onclick="downloadImage()" style="display:inline-flex;align-items:center;gap:8px;padding:12px 24px;border-radius:10px;font-family:var(--font-main);font-size:16px;font-weight:600;cursor:pointer;border:none;color:white;background:linear-gradient(135deg,var(--blue),var(--teal));">üì• Descargar imagen</button>
      <button onclick="shareWhatsApp()" style="display:inline-flex;align-items:center;gap:8px;padding:12px 24px;border-radius:10px;font-family:var(--font-main);font-size:16px;font-weight:600;cursor:pointer;border:none;color:white;background:#25D366;">üí¨ WhatsApp</button>
      <button onclick="shareTwitter()" style="display:inline-flex;align-items:center;gap:8px;padding:12px 24px;border-radius:10px;font-family:var(--font-main);font-size:16px;font-weight:600;cursor:pointer;border:none;color:white;background:#1DA1F2;">üê¶ Twitter/X</button>
      <button onclick="shareFacebook()" style="display:inline-flex;align-items:center;gap:8px;padding:12px 24px;border-radius:10px;font-family:var(--font-main);font-size:16px;font-weight:600;cursor:pointer;border:none;color:white;background:#1877F2;">üìò Facebook</button>
      <button onclick="copyLink()" style="display:inline-flex;align-items:center;gap:8px;padding:12px 24px;border-radius:10px;font-family:var(--font-main);font-size:16px;font-weight:600;cursor:pointer;border:none;color:var(--text-muted);background:var(--surface-3);border:1px solid var(--border);">üîó Copiar link</button>
    </div>
  </div>

  <div class="cta-card">
    <h3>¬øQuer√©s armar un plan financiero completo?</h3>
    <p>El fondo de emergencia es el primer paso. En el M√©todo FBC te ense√±o a ordenar tus finanzas, eliminar deudas, ahorrar con sistema e invertir con estrategia.</p>
    <a href="https://metodofbc.com" target="_blank" class="btn-cta">Conocer el M√©todo FBC ‚Üí</a>
  </div>
</div>

<div class="footer">
  <p>Herramienta gratuita creada por <a href="https://www.instagram.com/nicopassini_" target="_blank">@nicopassini_</a></p>
  <p style="margin-top:6px;">Con fines educativos. No constituye asesoramiento financiero, de inversi√≥n ni recomendaci√≥n de compra o venta de activos.</p>
</div>
</div>

<!-- SHARE CARD -->
<div class="share-card" id="shareCard">
  <div class="sc-header"><div class="sc-brand">NICO PASSINI</div><div class="sc-tool">FONDO DE EMERGENCIA</div></div>
  <div class="sc-main">
    <div class="sc-main-label">MI FONDO DE EMERGENCIA</div>
    <div class="sc-main-amount" id="scPct" style="color:var(--teal);"></div>
    <div class="sc-main-sub" id="scStatus"></div>
  </div>
  <div class="sc-stats">
    <div class="sc-stat"><div class="sc-stat-label">Objetivo</div><div class="sc-stat-val" id="scGoal" style="color:var(--teal);"></div></div>
    <div class="sc-stat"><div class="sc-stat-label">Tengo</div><div class="sc-stat-val" id="scHave"></div></div>
    <div class="sc-stat"><div class="sc-stat-label">Me falta</div><div class="sc-stat-val" id="scNeed" style="color:var(--orange);"></div></div>
  </div>
  <div class="sc-footer"><div class="sc-footer-text">Calcul√° el tuyo gratis en nicopassini.com</div><div class="sc-footer-ig">@nicopassini_</div></div>
</div>

<div class="toast" id="toast"></div>

<script>
let coverageMonths = 6;
let chartInstance = null;
let currency = 'ARS';

const DEFAULTS_ARS = [
  { name: 'Alquiler / Hipoteca', amount: 350000 },
  { name: 'Servicios (luz, gas, agua, internet)', amount: 80000 },
  { name: 'Supermercado / Comida', amount: 200000 },
  { name: 'Transporte', amount: 50000 },
  { name: 'Salud / Obra social', amount: 40000 },
];
const DEFAULTS_USD = [
  { name: 'Alquiler / Hipoteca', amount: 800 },
  { name: 'Servicios (luz, gas, agua, internet)', amount: 150 },
  { name: 'Supermercado / Comida', amount: 400 },
  { name: 'Transporte', amount: 100 },
  { name: 'Salud / Obra social', amount: 100 },
];

function init() {
  loadDefaults();
  fetchARS();
}

function loadDefaults() {
  document.getElementById('expenseList').innerHTML = '';
  expenseId = 0;
  const defaults = currency === 'ARS' ? DEFAULTS_ARS : DEFAULTS_USD;
  defaults.forEach(e => addExpense(e.name, e.amount));
}

function setCurrency(cur) {
  currency = cur;
  document.getElementById('btnARS').classList.toggle('active', cur==='ARS');
  document.getElementById('btnUSD').classList.toggle('active', cur==='USD');
  document.getElementById('savedSuffix').textContent = cur;
  document.getElementById('currentSaved').value = 0;
  loadDefaults();
  updateAllEquiv();
}

// ====== ARS ======
async function fetchARS() {
  const el=document.getElementById('arsSource'); const input=document.getElementById('arsRate');
  const apis=[{url:'https://dolarapi.com/v1/dolares/oficial',parse:d=>d.venta,name:'DolarAPI'},{url:'https://api.bluelytics.com.ar/v2/latest',parse:d=>d.oficial?.value_sell,name:'Bluelytics'}];
  for(const api of apis){try{const c=new AbortController();const t=setTimeout(()=>c.abort(),4000);const r=await fetch(api.url,{signal:c.signal});clearTimeout(t);if(!r.ok)continue;const d=await r.json();const rate=api.parse(d);if(rate&&rate>0){input.value=Math.round(rate);el.textContent='(auto ¬∑ '+api.name+')';updateAllEquiv();return;}}catch(e){continue;}}
  el.textContent='(manual)'; updateAllEquiv();
}

function getARS(){return parseFloat(document.getElementById('arsRate').value)||1200;}
function fmt(n){
  if(currency==='ARS') return '$ '+Math.round(n).toLocaleString('es-AR');
  return 'US$ '+Math.round(n).toLocaleString('en-US');
}
function fmtOther(n){
  if(currency==='ARS') return 'US$ '+Math.round(n/getARS()).toLocaleString('en-US');
  return 'ARS $ '+Math.round(n*getARS()).toLocaleString('es-AR');
}
function showEquiv(input,id){const el=document.getElementById(id);if(el)el.textContent='‚âà '+fmtOther(parseFloat(input.value)||0);}
function updateAllEquiv(){showEquiv(document.getElementById('currentSaved'),'savedEquiv');}

// ====== MONTHS ======
function setMonths(m, el) {
  coverageMonths = m;
  document.querySelectorAll('.month-btn').forEach(b=>b.classList.remove('active'));
  el.classList.add('active');
}

// ====== EXPENSES ======
let expenseId = 0;
function addExpense(name='', amount='') {
  const id = ++expenseId;
  const div = document.createElement('div');
  div.className = 'expense-item';
  div.setAttribute('data-id', id);
  div.innerHTML = `
    <div class="field" style="margin:0;"><label style="font-size:13px;">Gasto</label><input type="text" value="${name}" placeholder="Ej: alquiler" style="width:100%;background:var(--surface-3);border:1px solid var(--border);border-radius:8px;padding:10px 12px;color:var(--text);font-family:var(--font-main);font-size:16px;"></div>
    <div class="field" style="margin:0;"><label style="font-size:13px;">Monto</label><input type="number" class="exp-amount" value="${amount}" placeholder="0" min="0" style="width:100%;background:var(--surface-3);border:1px solid var(--border);border-radius:8px;padding:10px 12px;color:var(--text);font-family:var(--font-main);font-size:16px;"></div>
    <button class="btn-remove" onclick="removeExpense(${id})">√ó</button>`;
  document.getElementById('expenseList').appendChild(div);
}

function removeExpense(id) {
  const el = document.querySelector(`[data-id="${id}"]`);
  if(el) el.remove();
}

function getTotalMonthly() {
  let total = 0;
  document.querySelectorAll('.exp-amount').forEach(i => { total += parseFloat(i.value)||0; });
  return total;
}

// ====== CALCULATE ======
function calculate() {
  const monthly = getTotalMonthly();
  if(monthly <= 0) { alert('Ingres√° al menos un gasto mensual.'); return; }

  const goal = monthly * coverageMonths;
  const saved = parseFloat(document.getElementById('currentSaved').value)||0;
  const need = Math.max(0, goal - saved);
  const pct = Math.min(100, Math.round((saved / goal) * 100));

  // Status
  let status, statusText, statusColor, statusBg, statusBorder;
  if(pct >= 100) {
    status='green'; statusText='‚úÖ ¬°FONDO COMPLETO!'; statusColor='var(--green)'; statusBg='var(--green-bg)'; statusBorder='rgba(17,179,183,.35)';
  } else if(pct >= 50) {
    status='orange'; statusText='üîÑ EN PROGRESO'; statusColor='var(--orange)'; statusBg='var(--orange-bg)'; statusBorder='rgba(240,160,48,.35)';
  } else {
    status='red'; statusText='üö® NECESITA ATENCI√ìN'; statusColor='var(--red)'; statusBg='var(--red-bg)'; statusBorder='rgba(232,84,84,.35)';
  }

  // Ring
  const circ = 2 * Math.PI * 85;
  const offset = circ - (pct/100) * circ;
  const ring = document.getElementById('ringCircle');
  ring.style.stroke = statusColor;
  setTimeout(()=>{ ring.style.strokeDashoffset = offset; },100);
  document.getElementById('ringPct').textContent = pct + '%';
  document.getElementById('ringPct').style.color = statusColor;

  const hero = document.getElementById('ringHero');
  hero.className = 'ring-hero status-' + status;
  const badge = document.getElementById('heroStatus');
  badge.textContent = statusText;
  badge.style.background = statusBg;
  badge.style.color = statusColor;
  badge.style.border = '1px solid ' + statusBorder;

  document.getElementById('heroTitle').textContent = pct >= 100
    ? `Tu fondo cubre ${coverageMonths} meses de gastos. ¬°Excelente!`
    : `Necesit√°s ${fmt(goal)} para cubrir ${coverageMonths} meses de gastos`;

  document.getElementById('haGoal').textContent = fmt(goal);
  document.getElementById('haGoalARS').textContent = '‚âà ' + fmtOther(goal);
  document.getElementById('haHave').textContent = fmt(saved);
  document.getElementById('haHaveARS').textContent = '‚âà ' + fmtOther(saved);
  document.getElementById('haNeed').textContent = need > 0 ? fmt(need) : '‚Äî';
  document.getElementById('haNeedARS').textContent = need > 0 ? '‚âà ' + fmtOther(need) : '';

  // Plan
  renderPlan(need);

  // Chart
  renderChart(saved, need);

  // Where to keep
  renderWhere();

  // Recommendations
  renderRecos(pct, goal, saved, need, monthly, coverageMonths);

  // Share card
  document.getElementById('scPct').textContent = pct + '%';
  document.getElementById('scPct').style.color = statusColor;
  document.getElementById('scStatus').textContent = statusText;
  document.getElementById('scGoal').textContent = fmt(goal);
  document.getElementById('scHave').textContent = fmt(saved);
  document.getElementById('scNeed').textContent = need > 0 ? fmt(need) : '‚úÖ Completo';

  document.getElementById('results').classList.add('show');
  document.getElementById('results').scrollIntoView({behavior:'smooth',block:'start'});
}

function renderPlan(need) {
  const grid = document.getElementById('planGrid');
  grid.innerHTML = '';
  if(need <= 0) {
    document.getElementById('planDesc').textContent = '¬°Ya ten√©s tu fondo completo! Segu√≠ manteni√©ndolo.';
    return;
  }
  document.getElementById('planDesc').textContent = `Si ahorr√°s un monto fijo cada mes, as√≠ complet√°s tu fondo:`;
  const plans = [
    { months: 3, label: 'Intenso (3 meses)' },
    { months: 6, label: 'Moderado (6 meses)' },
    { months: 12, label: 'Relajado (12 meses)' }
  ];
  plans.forEach(p => {
    const perMonth = need / p.months;
    grid.innerHTML += `<div class="plan-card">
      <div class="pc-months">${p.label}</div>
      <div class="pc-amount">${fmt(perMonth)}/mes</div>
      <div class="pc-sub">‚âà ${fmtOther(perMonth)}/mes</div>
    </div>`;
  });
}

function renderChart(saved, need) {
  const ctx = document.getElementById('fundChart').getContext('2d');
  if(chartInstance) chartInstance.destroy();
  const goal = saved + need;
  if(need <= 0) {
    // Already complete - show simple bar
    chartInstance = new Chart(ctx, {
      type:'doughnut',
      data:{labels:['Tu fondo',''],datasets:[{data:[100,0],backgroundColor:['#11b3b7','#1c3a5a'],borderWidth:0}]},
      options:{responsive:true,plugins:{legend:{display:false}}}
    });
    return;
  }
  // Show 6-month plan progression
  const monthlyTarget = need / 6;
  const labels = [], values = [];
  for(let m=0;m<=6;m++){
    labels.push('Mes '+m);
    values.push(Math.min(goal, saved + monthlyTarget*m));
  }
  chartInstance = new Chart(ctx, {
    type:'line',
    data:{labels,datasets:[
      {label:'Tu fondo',data:values,borderColor:'#11b3b7',backgroundColor:'rgba(17,179,183,.12)',fill:true,tension:.3,pointRadius:3,pointBackgroundColor:'#11b3b7',borderWidth:2.5},
      {label:'Objetivo',data:Array(7).fill(goal),borderColor:'#f0a030',borderDash:[6,4],borderWidth:1.5,pointRadius:0,fill:false}
    ]},
    options:{responsive:true,maintainAspectRatio:true,plugins:{legend:{labels:{color:'#8da4bf',font:{size:13},usePointStyle:true,padding:20}},tooltip:{backgroundColor:'#132640',titleColor:'#e4eaf2',bodyColor:'#8da4bf',borderColor:'#1f4672',borderWidth:1,callbacks:{label:ctx=>ctx.dataset.label+': '+fmt(ctx.parsed.y)}}},scales:{x:{ticks:{color:'#8da4bf'},grid:{color:'rgba(31,70,114,.3)'}},y:{ticks:{color:'#8da4bf',callback:v=>fmt(v)},grid:{color:'rgba(31,70,114,.3)'}}}}
  });
}

function renderWhere() {
  const grid = document.getElementById('whereGrid');
  grid.innerHTML = '';
  const options = [
    {icon:'üè¶',name:'Cuenta remunerada / Caja de ahorro USD',desc:'Liquidez inmediata. Rendimiento bajo pero acceso en el momento. Ideal para la parte m√°s urgente.',badge:'M√ÅXIMA LIQUIDEZ',badgeBg:'var(--green-bg)',badgeColor:'var(--green)'},
    {icon:'üìä',name:'FCI Money Market (T+0/T+1)',desc:'Fondos comunes de inversi√≥n de liquidez inmediata. Rinden m√°s que una caja de ahorro y pod√©s rescatar en 24hs.',badge:'RECOMENDADO',badgeBg:'var(--accent-glow)',badgeColor:'var(--teal)'},
    {icon:'üíµ',name:'Plazo fijo corto (30 d√≠as)',desc:'Rendimiento algo mayor pero tu dinero queda inmovilizado 30 d√≠as. Usalo solo para la parte que no necesit√°s de urgencia.',badge:'RENDIMIENTO MEDIO',badgeBg:'var(--orange-bg)',badgeColor:'var(--orange)'},
    {icon:'üá∫üá∏',name:'D√≥lares billete / Stablecoins (USDT/USDC)',desc:'Protecci√≥n contra devaluaci√≥n. Pod√©s tener parte en d√≥lares f√≠sicos y parte en stablecoins con rendimiento.',badge:'PROTECCI√ìN CAMBIO',badgeBg:'var(--purple-bg)',badgeColor:'var(--purple)'}
  ];
  options.forEach(o => {
    grid.innerHTML += `<div class="where-card">
      <div class="where-icon">${o.icon}</div>
      <div class="where-info"><div class="where-name">${o.name}</div><div class="where-desc">${o.desc}</div></div>
      <div class="where-badge" style="background:${o.badgeBg};color:${o.badgeColor};border:1px solid ${o.badgeColor};">${o.badge}</div>
    </div>`;
  });
}

function renderRecos(pct, goal, saved, need, monthly, months) {
  const c = document.getElementById('recoContainer');
  if(pct >= 100) {
    c.innerHTML = `<div class="reco-box reco-green"><h4>üéâ ¬°Tu fondo de emergencia est√° completo!</h4><p>Ten√©s ${fmt(saved)} que cubren ${months} meses de gastos (${fmt(monthly)}/mes). Ahora el siguiente paso es invertir el excedente.</p><ul><li>No toques este fondo salvo para emergencias reales</li><li>Revisalo cada 6 meses por si cambiaron tus gastos</li><li>El dinero extra ahora s√≠ pod√©s destinarlo a inversi√≥n</li></ul></div>`;
  } else if(pct >= 50) {
    c.innerHTML = `<div class="reco-box reco-orange"><h4>üîÑ Vas bien, segu√≠ as√≠</h4><p>Ya ten√©s el ${pct}% de tu fondo (${fmt(saved)} de ${fmt(goal)}). Te faltan ${fmt(need)} para completarlo.</p><ul><li>Automatiz√° una transferencia mensual el d√≠a que cobr√°s</li><li>Prioriz√° completar el fondo antes de invertir en otra cosa</li><li>Si recib√≠s un ingreso extra (aguinaldo, bonus), destin√° parte al fondo</li></ul></div>`;
  } else {
    c.innerHTML = `<div class="reco-box reco-red"><h4>üö® Prioridad: armar tu fondo de emergencia</h4><p>Solo ten√©s el ${pct}% cubierto. Sin fondo de emergencia, cualquier imprevisto te puede llevar a endeudarte.</p><ul><li>Empez√° con un objetivo chico: 1 mes de gastos (${fmt(monthly)})</li><li>Reduc√≠ gastos no esenciales temporalmente hasta completar al menos 3 meses</li><li>Cualquier ingreso extra va directo al fondo hasta completarlo</li><li>No inviertas en nada hasta tener al menos 3 meses cubiertos</li></ul></div>`;
  }
}

// ====== SHARE ======
async function downloadImage() {
  const card=document.getElementById('shareCard');
  card.style.left='0';card.style.position='fixed';card.style.top='0';card.style.zIndex='9999';
  try{const canvas=await html2canvas(card,{backgroundColor:'#0d1b2e',scale:2,width:1080,useCORS:true,logging:false});card.style.left='-9999px';card.style.position='absolute';card.style.zIndex='auto';
  canvas.toBlob(async blob=>{if(navigator.share&&navigator.canShare){const file=new File([blob],'fondo-emergencia.png',{type:'image/png'});try{await navigator.share({title:'Fondo de Emergencia - Nico Passini',files:[file]});return;}catch(e){}}const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download='fondo-emergencia.png';a.click();URL.revokeObjectURL(url);showToast('‚úÖ Imagen descargada');},'image/png');
  }catch(e){card.style.left='-9999px';card.style.position='absolute';showToast('‚ùå Error al generar imagen');}
}

function shareWhatsApp() {
  const pct=document.getElementById('ringPct').textContent;
  const text=`üõ°Ô∏è Mi fondo de emergencia est√° al ${pct}\n\n¬øQuer√©s saber c√≥mo est√° el tuyo?\nüëâ nicopassini.com/fondo-emergencia.html`;
  window.open('https://wa.me/?text='+encodeURIComponent(text),'_blank');
}
function shareTwitter() {
  const pct=document.getElementById('ringPct').textContent;
  const text=`üõ°Ô∏è Mi fondo de emergencia: ${pct} completado\n\nCalcul√° el tuyo gratis üëá\nnicopassini.com/fondo-emergencia.html\n\nv√≠a @nicopassini_`;
  window.open('https://twitter.com/intent/tweet?text='+encodeURIComponent(text),'_blank');
}
function shareFacebook(){window.open('https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent('https://nicopassini.com/fondo-emergencia.html'),'_blank');}
function copyLink(){navigator.clipboard.writeText('https://nicopassini.com/fondo-emergencia.html').then(()=>showToast('‚úÖ Link copiado')).catch(()=>showToast('‚ùå No se pudo copiar'));}
function showToast(msg){const t=document.getElementById('toast');t.textContent=msg;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),2500);}

document.querySelectorAll('input').forEach(i=>i.addEventListener('keypress',e=>{if(e.key==='Enter')calculate();}));
init();
</script>
<!-- EMAIL POPUP - Nico Passini / FBC -->
<div id="emailPopup" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.65);backdrop-filter:blur(6px);z-index:9999;align-items:center;justify-content:center;">
  <div style="background:linear-gradient(160deg,#0d1b2e,#132640);border:1px solid #1f4672;border-radius:16px;padding:40px 32px;max-width:440px;width:90%;position:relative;animation:popIn .4s ease;">
    <button onclick="closePopup()" style="position:absolute;top:14px;right:14px;background:none;border:none;color:#8da4bf;font-size:22px;cursor:pointer;width:32px;height:32px;display:flex;align-items:center;justify-content:center;border-radius:8px;transition:all .2s;" onmouseover="this.style.background='rgba(232,84,84,.15)';this.style.color='#e85454'" onmouseout="this.style.background='none';this.style.color='#8da4bf'">‚úï</button>
    <div style="text-align:center;margin-bottom:24px;">
      <div style="font-size:40px;margin-bottom:12px;">üì¨</div>
      <h2 style="font-family:'Century Gothic','Questrial','Futura','Trebuchet MS',sans-serif;font-size:22px;font-weight:700;color:#fff;margin-bottom:8px;line-height:1.3;">Tips financieros gratis cada semana</h2>
      <p style="font-family:'Century Gothic','Questrial','Futura','Trebuchet MS',sans-serif;font-size:16px;color:#8da4bf;line-height:1.5;">Recib√≠ en tu mail estrategias simples para ahorrar, invertir y hacer crecer tu plata. Sin humo, sin spam.</p>
    </div>
    <div id="popupForm">
      <input type="text" id="popupName" placeholder="Tu nombre" style="width:100%;padding:14px 16px;background:#17304d;border:1.5px solid #1f4672;border-radius:10px;color:#e4eaf2;font-family:'Century Gothic','Questrial',sans-serif;font-size:15px;margin-bottom:10px;transition:border-color .25s;" onfocus="this.style.borderColor='#0b80e1'" onblur="this.style.borderColor='#1f4672'">
      <input type="email" id="popupEmail" placeholder="Tu mejor email" style="width:100%;padding:14px 16px;background:#17304d;border:1.5px solid #1f4672;border-radius:10px;color:#e4eaf2;font-family:'Century Gothic','Questrial',sans-serif;font-size:15px;margin-bottom:14px;transition:border-color .25s;" onfocus="this.style.borderColor='#0b80e1'" onblur="this.style.borderColor='#1f4672'">
      <button onclick="submitPopup()" style="width:100%;padding:16px;background:linear-gradient(135deg,#0b80e1,#11b3b7);border:none;border-radius:10px;color:#fff;font-family:'Century Gothic','Questrial',sans-serif;font-size:16px;font-weight:700;cursor:pointer;transition:all .3s;" onmouseover="this.style.transform='translateY(-2px)';this.style.boxShadow='0 8px 25px rgba(11,128,225,.3)'" onmouseout="this.style.transform='none';this.style.boxShadow='none'">Quiero recibirlos ‚Üí</button>
      <p style="text-align:center;font-size:13px;color:#8da4bf;opacity:.6;margin-top:10px;">0% spam. Te pod√©s desuscribir cuando quieras.</p>
    </div>
    <div id="popupSuccess" style="display:none;text-align:center;padding:20px 0;">
      <div style="font-size:48px;margin-bottom:12px;">üéâ</div>
      <h3 style="font-family:'Century Gothic','Questrial',sans-serif;font-size:20px;color:#11b3b7;margin-bottom:8px;">¬°Listo! Ya est√°s adentro</h3>
      <p style="font-family:'Century Gothic','Questrial',sans-serif;font-size:16px;color:#8da4bf;">Revis√° tu mail. El primer tip llega esta semana.</p>
    </div>
    <div style="text-align:center;margin-top:16px;padding-top:16px;border-top:1px solid #1f4672;">
      <span style="font-family:'Cormorant Garamond',Georgia,serif;font-size:16px;letter-spacing:3px;text-transform:uppercase;color:#8da4bf;">NICO PASSINI</span>
    </div>
  </div>
</div>
<style>
@keyframes popIn{from{opacity:0;transform:scale(.9) translateY(20px);}to{opacity:1;transform:scale(1) translateY(0);}}
#emailPopup input::placeholder{color:#5a7a9a;}
</style>
<script>
(function(){
  // CONFIG: Cambiar estos valores cuando tengas Klaviyo configurado
  const KLAVIYO_LIST_ID = 'TU_LIST_ID_ACA'; // Reemplazar con tu List ID de Klaviyo
  const KLAVIYO_PUBLIC_KEY = 'TU_PUBLIC_KEY_ACA'; // Reemplazar con tu Public API Key de Klaviyo
  const POPUP_DELAY_MS = 5000; // 5 segundos
  const POPUP_KEY = 'fbc_popup_shown';

  // No mostrar si ya se mostr√≥ en esta sesi√≥n
  if(sessionStorage.getItem(POPUP_KEY)) return;

  setTimeout(function(){
    const popup = document.getElementById('emailPopup');
    if(popup) popup.style.display = 'flex';
    sessionStorage.setItem(POPUP_KEY, '1');
  }, POPUP_DELAY_MS);
})();

function closePopup(){
  document.getElementById('emailPopup').style.display = 'none';
}

function submitPopup(){
  const name = document.getElementById('popupName').value.trim();
  const email = document.getElementById('popupEmail').value.trim();
  if(!email || !email.includes('@')){
    document.getElementById('popupEmail').style.borderColor = '#e85454';
    return;
  }

  // === KLAVIYO API INTEGRATION ===
  // Cuando tengas tus keys, descomentar este bloque:
  /*
  const KLAVIYO_LIST_ID = 'TU_LIST_ID_ACA';
  const KLAVIYO_PUBLIC_KEY = 'TU_PUBLIC_KEY_ACA';
  fetch('https://a.klaviyo.com/api/v2/list/' + KLAVIYO_LIST_ID + '/subscribe?api_key=' + KLAVIYO_PUBLIC_KEY, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      profiles: [{ email: email, first_name: name, source: 'Herramientas FBC - ' + document.title }]
    })
  }).catch(function(e){ console.log('Klaviyo error:', e); });
  */

  // Mientras tanto, log en consola para testing
  console.log('üì¨ Nuevo suscriptor:', { name, email, source: document.title });

  // Mostrar √©xito
  document.getElementById('popupForm').style.display = 'none';
  document.getElementById('popupSuccess').style.display = 'block';
  setTimeout(closePopup, 3000);
}

// Cerrar con ESC
document.addEventListener('keydown', function(e){
  if(e.key === 'Escape') closePopup();
});
// Cerrar al hacer click fuera
document.getElementById('emailPopup')?.addEventListener('click', function(e){
  if(e.target === this) closePopup();
});
</script>

<script src="lead-gate.js"></script>
</body>
</html>
